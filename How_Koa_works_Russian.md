Koa не использует async/await, и даже генераторы. твои middleware принимают контекст Koa и next - функция, следующая за текущей в middleware-stack и возвращающая промис. Когда ты выполняешь app.callback(), то получаешь функцию, которая получает req и res и вызывает compose - функцию, принимающую массив функций (middleware-стек) и возвращающую функцию, которая является композицией массива этих функций. Результат compose, функция, получает конекст Koa и возвращает промис, на then которого вешается respond, а на catch - создается событие error в контексте. контекст на каждый запрос создается новый
